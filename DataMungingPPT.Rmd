---
title: "DataMunging PPT"
author: "Melvin Adkins, Raymond Blaha, Paul Hwang, Stephanie Diaz Ortega"
output: ioslides_presentation
fontsize: 12pt
---

## IMDB Top 250 Movies

- Set of 250 movie data from IMDB
- (https://www.kaggle.com/datasets/yehorkorzh/imdb-top-250-movies)

## Variables

- Num
- Title
- Year
- Released
- Runtime
- Genre
- Director
- Writer
- Actor
- Plot
- Language
- Country
- Awards
- Metascore
- imdbRating
- imdbVotes
- imdbID
- Type
- DVD
- BoxOffice
- Production
- Website

## DataMunging Pt1

### Type Modification

- Runtime
- BoxOffice
- imdbVoting

## DataMunging Pt2

### Data Split
- Genre
- Actor
- Writer
- Language
- Country
- Awards

## DataMunging Pt3

### Removed
- Released
- Plot
- imdbID
- Type
- DVD
- Website

## Exploratory Data Analysis
- 1D Analysis

```{r, echo = FALSE, results=FALSE, message=FALSE, warning=FALSE, comment=FALSE, cache = TRUE}
library(data.table)

## Loading Data
data.wide <- "C:\\Users\\pauld\\OneDrive\\Desktop\\Data Munging\\Final Project\\DataMungingProject\\MovieCleanFull.csv"
movie.wide <- fread(data.wide)

```

## Year
- Mean: 1982.676
- SD: 24.80921

```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
library(ggplot2)
library(cowplot)

# mean(movie.wide$Year)
# sd(movie.wide$Year)

gp <- ggplot(data = movie.wide, aes(x = Year)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,25), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = Year)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = Year)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   scale_y_continuous(limits= c(0,0.03), expand = c(0,0)) +
#   theme_light()
```

## Runtime
- Mean: 126.808
- SD: 29.76338

```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$Runtime)
# sd(movie.wide$Runtime)

gp <- ggplot(data = movie.wide, aes(x = Runtime)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,25), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = Runtime)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = Runtime)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   scale_y_continuous(limits= c(0,0.02), expand = c(0,0)) +
#   theme_light()
```


## Directors Pt1
- Unique Directors: 155
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
library(plotly)
library(plyr)

# length(unique(movie.wide$Director))

table.dir <- plyr::count(movie.wide$Director)
gp <- ggplot(data = movie.wide, aes(x=Director)) +
  geom_bar(stat = "count",color = "black", fill = "lightblue")
ggplotly(gp)
```

## Directors Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
table.dir[table.dir$freq > 3,]
```

## Directors Pt3
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
gp2 <- ggplot(data = table.dir[table.dir$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity",color = "black", fill = "lightblue") +
  theme(axis.text.x = element_text(angle = 90)) + xlab("Directors")
ggplotly(gp2)
```


## Writers
- Unique Writers: 213

```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# length(unique(movie.wide$Writer))

table.wri <- plyr::count(movie.wide$Writer)
gp <- ggplot(data = table.wri, aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue")
# ggplotly(gp)

table.wri[table.wri$freq > 3,]
gp2 <- ggplot(data = table.wri[table.wri$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") + xlab("Writers")
ggplotly(gp2)
```

## Metascore
- Mean: 80.0452
- SD: 11.03034
```{r, echo=FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$Metascore, na.rm = TRUE)
# sd(movie.wide$Metascore, na.rm = TRUE)

gp <- ggplot(data = movie.wide, aes(x = Metascore)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,15), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = Metascore)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = Metascore)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   scale_y_continuous(limits= c(0,0.05), expand = c(0,0)) +
#   theme_light()
```

## imbdRating
- Mean: 8.244
- SD: 0.2457347
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$imdbRating)
# sd(movie.wide$imdbRating)

gp <- ggplot(data = movie.wide, aes(x = imdbRating)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,40), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = imdbRating)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()

plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = imdbRating)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   scale_y_continuous(limits= c(0,7.5), expand = c(0,0)) +
#   theme_light()
```


## imbdVotes
- Mean: 431401.3
- SD: 367703.3
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$imdbVotes, na.rm = TRUE)
# sd(movie.wide$imdbVotes, na.rm = TRUE)

gp <- ggplot(data = movie.wide, aes(x = imdbVotes)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,30), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = imdbVotes)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = imdbVotes)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   theme_light()
```

## boxoffice
- Mean: 158727934
- SD: 169133912
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$BoxOffice, na.rm = TRUE)
# sd(movie.wide$BoxOffice, na.rm = TRUE)

gp <- ggplot(data = movie.wide, aes(x = BoxOffice)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,15), expand = c(0,0)) +
  theme_light()
gp2 <- ggplot(data = movie.wide, aes(x = BoxOffice)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = BoxOffice)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   theme_light()
```

## Production Pt1
- Unique Productions: 89
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# length(unique(movie.wide$Production))

table.pro <- plyr::count(movie.wide$Production)
gp <- ggplot(data = table.pro, aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue")
ggplotly(gp)

table.pro[table.pro$freq > 3,]

# gp2 <- ggplot(data = table.pro[table.pro$freq > 3,], aes(x=x, y=freq)) +
#   geom_bar(stat = "identity", color = "black", fill = "lightblue") +
#   theme(axis.text.x = element_text(angle = 90))
# ggplotly(gp2)
```

## Production Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# length(unique(movie.wide$Production))

# table.pro <- plyr::count(movie.wide$Production)
# gp <- ggplot(data = table.pro, aes(x=x, y=freq)) +
#   geom_bar(stat = "identity", color = "black", fill = "lightblue")
# ggplotly(gp)

# table.pro[table.pro$freq > 3,]

gp2 <- ggplot(data = table.pro[table.pro$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  theme(axis.text.x = element_text(angle = 90)) + xlab("production")
ggplotly(gp2)
```

## Actors and Actress Pt1
- Actors and Actress: 773
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
library(tidyr)
actors.data <- movie.wide[,c("First Actor", "Second Actor", "Third Actor", "Fourth Actor")]
actors <- actors.data %>% pivot_longer(
  cols=c("First Actor", "Second Actor", "Third Actor", "Fourth Actor"),
  names_to = "Actors Type",
  values_to = "Actor"
)

# length(unique(actors$Actor))

table.act <- plyr::count(actors$Actor)
gp <- ggplot(data = table.act, aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue")
# ggplotly(gp)

table.act[table.act$freq > 3,]

# gp2 <- ggplot(data = table.act[table.act$freq > 3,], aes(x=x, y=freq)) +
#   geom_bar(stat = "identity", color = "black", fill = "lightblue") +
#   theme(axis.text.x = element_text(angle = 90))
# ggplotly(gp2)
```

## Actors and Actress Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
gp2 <- ggplot(data = table.act[table.act$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  theme(axis.text.x = element_text(angle = 90)) + xlab("Actors and Actresses")
ggplotly(gp2)
```

## Awards Pt1
- Mean: 29.44
- SD: 40.12799
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$Awards, na.rm = TRUE)
# sd(movie.wide$Awards, na.rm = TRUE)

gp <- ggplot(data = movie.wide, aes(x = Awards)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,30), expand = c(0,0)) +
  theme_light()
# ggplotly(gp)

gp2 <- ggplot(data = movie.wide, aes(x = Awards)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = Awards)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   theme_light()
```

## Awards Pt2
```{r, echo = FALSE, warning = FALSE, comment=FALSE, cache = TRUE, message=FALSE}
movie.wide[movie.wide$Awards > 75 ,c("Title", "Awards", "imdbRating")]
```


## Nominations Pt1
- Mean: 40.308
- SD: 52.18792
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
# mean(movie.wide$Nominations, na.rm = TRUE)
# sd(movie.wide$Nominations, na.rm = TRUE)

gp <- ggplot(data = movie.wide, aes(x = Nominations)) + 
  geom_histogram(color = "black", fill = "lightblue") +
  scale_y_continuous(limits= c(0,30), expand = c(0,0)) +
  theme_light()
# ggplotly(gp)

gp2 <- ggplot(data = movie.wide, aes(x = Nominations)) + 
  geom_boxplot(color = "black", fill = "lightblue") +
  theme_void()
plot_grid(gp, gp2, ncol = 1, align = "v", rel_heights = c(4,1), axis = "lr")

# ggplot(data = movie.wide, aes(x = Nominations)) + 
#   geom_histogram(aes(y = ..density..), color = "black", fill = "lightblue") + 
#   geom_density(alpha = 0.1, fill = "red") +
#   theme_light()
```

## Nominations Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
movie.wide[movie.wide$Nominations > 120,c("Title", "Nominations", "imdbRating")]
```

## Awards and Nominations Pt1
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
## showing deviations for awards and nominations
movie.wide[movie.wide$Awards > 75 | movie.wide$Nominations > 120,
           c("Title", "Awards", "Nominations", "imdbRating")]
```

## Awards and Nominations Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
## showing deviations for awards and nominations
movie.wide[movie.wide$Awards > 75 & movie.wide$Nominations > 120,
           c("Title", "Awards", "Nominations", "imdbRating")]
```

## Awards and Nominations Pt3
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
## showing deviations for awards and nominations
movie.wide[movie.wide$Awards > 75 & movie.wide$Nominations < 120,
           c("Title", "Awards", "Nominations", "imdbRating")]
```


## Genre
- Unique Genres: 24
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
genre.data <- movie.wide[,c("First Genre", "Second Genre", "Third Genre")]
genres <- genre.data %>% pivot_longer(
  cols=c("First Genre", "Second Genre", "Third Genre"),
  names_to = "Genre Type",
  values_to = "Genre"
)

# length(unique(genres$Genre))

table.gen <- na.omit(plyr::count(genres$Genre))

gp <- ggplot(data = table.gen, aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  scale_y_continuous(limits = c(0,180), expand = c(0,0)) +
  theme(axis.text.x = element_text(angle = 90)) + xlab("Genres")
ggplotly(gp)
```

## Language Pt1
- Unique Language: 44
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
lang.data <- movie.wide[,c("l1","l2","l3","l4","l5","l6","l7")]
language <- lang.data %>% pivot_longer(
  cols=c("l1","l2","l3","l4","l5","l6","l7"),
  names_to = "Language Type",
  values_to = "Language"
)

# length(unique(language$Language))

table.lang <- na.omit(plyr::count(language$Language))

gp <- ggplot(data = table.lang, aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  scale_y_continuous(limits = c(0,260), expand = c(0,0)) +
  theme(axis.text.x = element_text(angle = 90))
# ggplotly(gp)

table.lang[table.lang$freq > 3,]
```



## Language Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
gp2 <- ggplot(data = table.lang[table.lang$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  scale_y_continuous(limits = c(0,260), expand = c(0,0)) + 
  theme(axis.text.x = element_text(angle = 90)) + xlab("Language")
ggplotly(gp2)
```

## Country Pt1
- Unique Countries: 31
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
coun.data <- movie.wide[,c("c1","c2","c3","c4","c5","c6","c7","c8","c9")]
country <- coun.data %>% pivot_longer(
  cols=c("c1","c2","c3","c4","c5","c6","c7","c8","c9"),
  names_to = "Country Type",
  values_to = "Country"
)

length(unique(country$Country))

table.coun <- na.omit(plyr::count(country$Country))
# gp <- ggplot(data = table.coun, aes(x=x, y=freq)) +
#   geom_bar(stat = "identity", color = "black", fill = "lightblue") +
#   scale_y_continuous(limits = c(0,260), expand = c(0,0)) + 
#   theme(axis.text.x = element_text(angle = 90))
# ggplotly(gp)

table.coun[table.coun$freq > 3,]
```

## Country Pt2
```{r, echo = FALSE, warning=FALSE, comment=FALSE, cache = TRUE, message=FALSE}
gp2 <- ggplot(data = table.coun[table.coun$freq > 3,], aes(x=x, y=freq)) +
  geom_bar(stat = "identity", color = "black", fill = "lightblue") +
  scale_y_continuous(limits = c(0,260), expand = c(0,0)) +
  theme(axis.text.x = element_text(angle = 90))
ggplotly(gp2)
```


## Number of Awards, BoxOffice, and imbdRatings Pt1

```{r, echo = FALSE, message=FALSE, warning=FALSE}
library(ggplot2)
library(plotly)
mag1 <- ggplot(movie.wide, aes(x = BoxOffice, y = Awards, color = Metascore, label1 = Title, label2=Year, label3='First Genre', label4='Second Genre', label5='Third Genre')) + 
  geom_point() +
  geom_hline(yintercept = 29.44, linetype = "dashed", color = "blue") +
  geom_vline(xintercept = mean(movie.wide$BoxOffice, na.rm=TRUE), 
             linetype = "dashed", color = "blue")
ggplotly(mag1)
  
```

<!-- - Top Left Region  -->
<!-- - Films of the imdb Top 250 list which had above avg Awards (29) but below avg Box Office (159M) -->
<!-- - Those films also show lighter shade of points => higher Metascore ratings -->
<!-- - Range of Year: 1994-2017  -->
<!-- - We might expect movies with high Award counts to have higher Box Office  -->


## Number of Awards, BoxOffice, and imbdRatings Pt2


<!-- * Top Left Region -->
<!-- * Films show darker shades of blue => lower ratings with respect to imdb ratings -->
<!-- * Indicates differences in how people rate between imdb and Metascore -->
<!-- * Range of Year: 1994-2017 -->
<!-- * Films with Biography or Drama as first genre were mostly clustered in this region -->

```{r, echo = FALSE, message=FALSE, warning=FALSE}
mag2 <- ggplot(movie.wide, aes(x = BoxOffice, y = Awards, color = imdbRating, label1=Title, label2=Year, shape='First Genre', lable3='Second Genre', label4='Third Genre')) + geom_point() +
  geom_hline(yintercept = 29.44, linetype = "dashed", color = "blue") +
  geom_vline(xintercept = mean(movie.wide$BoxOffice, na.rm=TRUE), linetype = "dashed", color = "blue") 
ggplotly(mag2)
```



